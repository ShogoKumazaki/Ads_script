<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google広告スクリプト セットアップガイド</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            line-height: 1.6;
            color: #fff;
            padding: 20px;
            background: #1a1a1a;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #2c2c2c;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }
        h1 {
            color: #fff;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #3498db;
            margin-top: 40px;
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        }
        h3 {
            color: #fff;
            margin-top: 30px;
        }
        .script-list {
            list-style: none;
            padding-left: 0;
        }
        .script-list li {
            margin-bottom: 15px;
            padding: 10px;
            background: #333;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .script-list li:hover {
            background: #444;
            transform: translateX(5px);
        }
        .script-list a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }
        .script-list a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        .setup-steps {
            background: #333;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .setup-steps ol {
            padding-left: 20px;
        }
        .setup-steps li {
            margin-bottom: 10px;
        }
        code {
            background: #1a1a1a;
            color: #fff;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }
        .note-box {
            background: #2c2c2c;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        .troubleshooting {
            background: #2c2c2c;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        pre {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        pre code {
            background: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Google広告スクリプト セットアップガイド</h1>

        <h2>概要</h2>
        <p>このリポジトリには、Google広告のレポートを自動取得し、Googleスプレッドシートに出力するスクリプトが含まれています。</p>

        <h2>テンプレートスプレッドシート</h2>
        <p>以下のテンプレートスプレッドシートを使用して、レポートの出力先として設定します：</p>
        <p><a href="https://docs.google.com/spreadsheets/d/1MBdF2FHNYp77P-MCGQxF7l5ZHbgtbzyYaVVVKJTQDJ8/edit?usp=sharing" target="_blank" rel="noopener noreferrer">広告レポート_テンプレート</a></p>

        <h2>スクリプト一覧</h2>
        <ul class="script-list">
            <li><a href="https://github.com/ShogoKumazaki/Ads_script/blob/main/daily.js" target="_blank" rel="noopener noreferrer">daily.js</a> - 日次レポート</li>
            <li><a href="https://github.com/ShogoKumazaki/Ads_script/blob/main/prefectures.js" target="_blank" rel="noopener noreferrer">prefectures.js</a> - 都道府県別レポート</li>
            <li><a href="https://github.com/ShogoKumazaki/Ads_script/blob/main/timeSlot.js" target="_blank" rel="noopener noreferrer">timeSlot.js</a> - 時間帯別レポート</li>
            <li><a href="https://github.com/ShogoKumazaki/Ads_script/blob/main/query.js" target="_blank" rel="noopener noreferrer">query.js</a> - 検索クエリレポート</li>
            <li><a href="https://github.com/ShogoKumazaki/Ads_script/blob/main/keyword.js" target="_blank" rel="noopener noreferrer">keyword.js</a> - キーワードレポート</li>
            <li><a href="https://github.com/ShogoKumazaki/Ads_script/blob/main/conversions_action_daily.js" target="_blank" rel="noopener noreferrer">conversions_action_daily.js</a> - コンバージョンアクション別レポート</li>
        </ul>

        <h2>セットアップ手順</h2>

        <h3>1. スプレッドシートの準備</h3>
        <div class="setup-steps">
            <ol>
                <li>テンプレートスプレッドシートをコピーして新しいスプレッドシートを作成</li>
                <li>スプレッドシートのIDをコピー（URLの <code>/d/</code> と <code>/edit</code> の間の文字列）</li>
            </ol>
        </div>

        <h3>2. スクリプトの設定</h3>
        <div class="setup-steps">
            <p>各スクリプトで以下の手順を実行します：</p>
            <ol>
                <li>Google広告のスクリプトエディタを開く
                    <ul>
                        <li>Google広告アカウントにログイン</li>
                        <li>左側のメニューから「ツールと設定」をクリック</li>
                        <li>「スクリプト」を選択</li>
                    </ul>
                </li>
                <li>新しいスクリプトを作成
                    <ul>
                        <li>「+」ボタンをクリック</li>
                        <li>「新しいスクリプト」を選択</li>
                    </ul>
                </li>
                <li>対応するスクリプトファイルの内容をコピー＆ペースト</li>
                <li><code>SPREADSHEET_ID</code>の値を、コピーしたスプレッドシートのIDに変更</li>
            </ol>
            <pre><code>// 例：
const SPREADSHEET_ID = '1MBdF2FHNYp77P-MCGQxF7l5ZHbgtbzyYaVVVKJTQDJ8';</code></pre>
        </div>

        <h3>3. スクリプトの実行設定</h3>
        <div class="setup-steps">
            <ol>
                <li>スクリプトエディタで「トリガー」を設定</li>
                <li>実行頻度を設定（推奨：毎日1回）</li>
            </ol>
        </div>

        <h2>各スクリプトの説明</h2>

        <h3>daily.js</h3>
        <ul>
            <li>日次の広告パフォーマンスデータを取得</li>
            <li>キャンペーン、広告グループ、コンバージョンアクションのデータを出力</li>
        </ul>

        <h3>prefectures.js</h3>
        <ul>
            <li>都道府県別の広告パフォーマンスデータを取得</li>
            <li>過去3ヶ月分のデータを出力</li>
        </ul>

        <h3>timeSlot.js</h3>
        <ul>
            <li>時間帯別の広告パフォーマンスデータを取得</li>
            <li>過去3ヶ月分のデータを出力</li>
        </ul>

        <h3>query.js</h3>
        <ul>
            <li>検索クエリのパフォーマンスデータを取得</li>
            <li>昨日、過去7日、過去30日、過去90日のデータを出力</li>
        </ul>

        <h3>keyword.js</h3>
        <ul>
            <li>キーワードのパフォーマンスデータを取得</li>
            <li>昨日、過去7日、過去30日、過去90日のデータを出力</li>
        </ul>

        <h3>conversions_action_daily.js</h3>
        <ul>
            <li>コンバージョンアクション別のパフォーマンスデータを取得</li>
            <li>キャンペーンと広告グループの両方のレベルでデータを出力</li>
            <li>過去3ヶ月分のデータを出力</li>
        </ul>

        <h2>注意事項</h2>
        <div class="note-box">
            <ul>
                <li>スクリプトの実行には、Google広告アカウントへの適切なアクセス権限が必要です</li>
                <li>スプレッドシートへの書き込み権限が必要です</li>
                <li>大量のデータを取得する場合は、実行時間制限に注意してください</li>
            </ul>
        </div>

        <h2>トラブルシューティング</h2>
        <div class="troubleshooting">
            <ul>
                <li>スクリプトが実行されない場合は、トリガーの設定を確認してください</li>
                <li>データが出力されない場合は、スプレッドシートIDが正しいか確認してください</li>
                <li>エラーが発生した場合は、Google広告アカウントの権限を確認してください</li>
            </ul>
        </div>
    </div>
</body>
</html> 