# tatsuya様作業手順書
## Google広告スクリプト設定・運用マニュアル

### 概要
この手順書では、Google広告のレポート自動化のため、以下の2つのスクリプトとスプレッドシートを設定する方法を説明します。

**提供されるファイル：**
- キャンペーンレポートスクリプト：https://github.com/ShogoKumazaki/Ads_script/blob/main/daily.js
- コンバージョンアクションレポートスクリプト：https://github.com/ShogoKumazaki/Ads_script/blob/main/conversions_action_daily.js
- スプレッドシートテンプレート：https://docs.google.com/spreadsheets/d/1lP77ZE4di3oZWp9lNockZ1ORgI8jvFe36zEJN5UhnjU/edit?gid=0#gid=0

---

## 事前準備

### 1. Google広告アカウントへのアクセス確認
- Google広告アカウントにログインできることを確認
- スクリプト実行権限があることを確認

### 2. Googleスプレッドシートの準備
1. 提供されたスプレッドシートテンプレートにアクセス
   - URL: https://docs.google.com/spreadsheets/d/1lP77ZE4di3oZWp9lNockZ1ORgI8jvFe36zEJN5UhnjU/edit?gid=0#gid=0
2. 「ファイル」→「コピーを作成」をクリック
   **※スクリーンショット推奨箇所：スプレッドシートのコピー作成画面**
3. 適切な名前を付けて保存
4. 作成したスプレッドシートのURLをコピーして保管

### 3. スプレッドシート内の設定値を変更

**重要：**スプレッドシート内の「キャンペーンA」シートで、赤字で表示されている以下の項目を実際の広告アカウントの設定に合わせて変更してください。

1. **「キャンペーンA」シートを開く**
   **※スクリーンショット推奨箇所：キャンペーンAシートの表示**

2. **赤字の項目を変更：**
   - **「キャンペーンA」** → 実際のキャンペーン名に変更
   - **「コンバージョンA」** → 実際のコンバージョンアクション名に変更  
   - **「コンバージョンB」** → 実際のコンバージョンアクション名に変更

3. **変更方法：**
   - 該当セルをクリック
   - 赤字のテキストを削除
   - 実際のGoogle広告アカウントで設定している名称を入力
   **※スクリーンショット推奨箇所：セルの編集画面**

4. **確認事項：**
   - キャンペーン名：Google広告管理画面の「キャンペーン」タブで確認できる名称と完全一致させる
   - コンバージョンアクション名：Google広告管理画面の「ツールと設定」→「測定」→「コンバージョン」で確認できる名称と完全一致させる

**注意：名称が完全に一致しない場合、スクリプトが正常に動作しません。**

---

## スクリプト設定手順

### ステップ1: Google広告スクリプト管理画面にアクセス

1. Google広告アカウントにログイン
2. 左側メニューから「ツールと設定」→「バルクアクション」→「スクリプト」をクリック
   **※スクリーンショット推奨箇所：スクリプトメニューの場所**

### ステップ2: キャンペーンレポートスクリプトの設定

#### 2-1. GitHubからスクリプトをコピー

1. 以下のURLにアクセス：
   https://github.com/ShogoKumazaki/Ads_script/blob/main/daily.js
   **※スクリーンショット推奨箇所：GitHubのスクリプトページ**

2. GitHubページの右上にある「Copy raw file」ボタン（📋アイコン）をクリック
   - または、「Raw」ボタンをクリックしてから全選択（Ctrl+A）→コピー（Ctrl+C）
   **※スクリーンショット推奨箇所：GitHubのCopyボタンの位置**

#### 2-2. Google広告スクリプトに設定

1. 「+」ボタンをクリックして新しいスクリプトを作成
   **※スクリーンショット推奨箇所：新規スクリプト作成ボタン**

2. スクリプト名を入力：「キャンペーン日次レポート」

3. GitHubからコピーしたスクリプトの内容を貼り付け（Ctrl+V）

4. **重要：スプレッドシートURLの設定**
   - スクリプト内の以下の行を見つける：
   ```javascript
   const SPREADSHEET_URL = 'YOUR_SPREADSHEET_URL_HERE';
   ```
   - 'YOUR_SPREADSHEET_URL_HERE'の部分を、ステップ2で作成したスプレッドシートのURLに置き換える

5. 「承認」ボタンをクリックして権限を付与
   **※スクリーンショット推奨箇所：承認画面**

6. 「プレビュー」ボタンでテスト実行
   - エラーが出ないことを確認
   - スプレッドシートにデータが書き込まれることを確認

### ステップ3: コンバージョンアクションレポートスクリプトの設定

#### 3-1. GitHubからスクリプトをコピー

1. 以下のURLにアクセス：
   https://github.com/ShogoKumazaki/Ads_script/blob/main/conversions_action_daily.js

2. GitHubページの右上にある「Copy raw file」ボタン（📋アイコン）をクリック
   - または、「Raw」ボタンをクリックしてから全選択（Ctrl+A）→コピー（Ctrl+C）

#### 3-2. Google広告スクリプトに設定

1. 再度「+」ボタンをクリックして新しいスクリプトを作成

2. スクリプト名を入力：「コンバージョンアクション日次レポート」

3. GitHubからコピーしたスクリプトの内容を貼り付け

4. **重要：スプレッドシートURLの設定**
   - キャンペーンレポートスクリプトと同様に、スプレッドシートURLを設定

5. 「承認」ボタンをクリックして権限を付与

6. 「プレビュー」ボタンでテスト実行

---

## スケジュール設定

### 両方のスクリプトに以下の設定を行います：

1. 各スクリプトの詳細画面で「頻度」をクリック
   **※スクリーンショット推奨箇所：頻度設定画面**

2. 実行頻度を設定：
   - **推奨設定：毎日 午前9:00**
   - 時間帯は業務開始前がおすすめ

3. 「保存」をクリック

---

## 動作確認とトラブルシューティング

### 正常動作の確認方法

1. **スプレッドシートの確認**
   - 各シートにデータが正しく入力されているか確認
   - 日付が正しく更新されているか確認

2. **スクリプト実行履歴の確認**
   - Google広告のスクリプト画面で「実行履歴」を確認
   - エラーメッセージがないことを確認
   **※スクリーンショット推奨箇所：実行履歴画面**

### よくあるエラーと対処法

| エラー内容 | 原因 | 対処法 |
|-----------|------|--------|
| スプレッドシートにアクセスできません | URL設定ミス | スプレッドシートURLを再確認 |
| 権限エラー | 承認未完了 | スクリプトの承認を再実行 |
| データが更新されない | スケジュール設定ミス | 頻度設定を再確認 |
| GitHubページが開けない | URL入力ミス | 提供されたURLを正確にコピー |

### GitHubからのスクリプト取得時の注意点

- **ブラウザの確認**: GitHubにアクセスできるブラウザを使用
- **コピー方法の選択**: 「Copy raw file」ボタンが推奨（一括でコピーできるため）
- **文字化け対策**: 日本語環境で問題ない場合は、Rawボタン経由でも可能

---
